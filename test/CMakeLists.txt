include(helper.cmake)

set(testdir "${CMAKE_CURRENT_BINARY_DIR}")
set(tmpdir "${CMAKE_CURRENT_BINARY_DIR}/tmp")
file(MAKE_DIRECTORY "${tmpdir}")

add_compile_definitions(TESTDIR="${testdir}")
add_compile_definitions(TMPDIR="${tmpdir}")

deciphon_download(minifam.hmm)
deciphon_download(minifam.dcp)
deciphon_download(minifam.hmm)
deciphon_download(consensus.json)
deciphon_download(prods_file_20221021.tsv)
deciphon_download(query1.fna)
deciphon_download(consensus_homoserine.fna)
deciphon_download(consensus_aa_kinase.fna)
deciphon_download(consensus_23isl.fna)
deciphon_download(ross.fna)
deciphon_download(ross.5.hmm)

deciphon_add_test(standard_profile DECIPHON::deciphon)
deciphon_add_test(protein_model DECIPHON::deciphon)
deciphon_add_test(protein_profile DECIPHON::deciphon)
deciphon_add_test(protein_db DECIPHON::deciphon)
# deciphon_add_test(hmmer_server DECIPHON::deciphon)
# deciphon_add_test(hmmer_client DECIPHON::deciphon)
# deciphon_add_test(scan DECIPHON::deciphon)
deciphon_add_test(prodfile_reader DECIPHON::deciphon)

# set(SRC ${CMAKE_CURRENT_SOURCE_DIR})
# set(DST ${CMAKE_CURRENT_BINARY_DIR})

# file(CREATE_LINK "${SRC}/decy.bats" "${DST}/decy.bats" COPY_ON_ERROR)
# file(CREATE_LINK "${SRC}/schedy.bats" "${DST}/schedy.bats" COPY_ON_ERROR)
# file(CREATE_LINK "${SRC}/pressy.bats" "${DST}/pressy.bats" COPY_ON_ERROR)
# file(CREATE_LINK "${SRC}/scanny.bats" "${DST}/scanny.bats" COPY_ON_ERROR)
# file(CREATE_LINK "${SRC}/helper.bash" "${DST}/helper.bash" COPY_ON_ERROR)
# file(CREATE_LINK "${SRC}/manifest" "${DST}/manifest" COPY_ON_ERROR)
#
# find_program(BATS_PROGRAM bats REQUIRED)

# add_test(test_pressy "${BATS_PROGRAM}" "${DST}/pressy.bats")
# add_test(test_scanny "${BATS_PROGRAM}" "${DST}/scanny.bats")
# add_test(test_schedy "${BATS_PROGRAM}" "${DST}/schedy.bats")
# add_test(test_decy "${BATS_PROGRAM}" "${DST}/decy.bats")
